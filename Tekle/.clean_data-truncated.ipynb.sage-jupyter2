{"backend_state":"init","connection_file":"/projects/4effcd42-8465-43b7-9c63-162fa4ffa93e/.local/share/jupyter/runtime/kernel-cd7b7d85-71fe-47ba-9dcc-834036d82465.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"colab":{"name":"clean_data.ipynb","provenance":[]},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1657304043501,"exec_count":3,"id":"bd126f","input":"# Add your imports here!\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.svm import SVC","kernel":"ds_env","metadata":{"id":"0gdnau9F-eWQ"},"pos":0,"start":1657304040948,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304045383,"exec_count":4,"id":"bc62d9","input":"# Read data\ndata = pd.read_csv(\"Data/heart_2020_cleaned.csv\")","kernel":"ds_env","metadata":{"id":"-3JsDsVW-eWS"},"pos":1,"start":1657304044250,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304048257,"exec_count":5,"id":"b539d6","input":"data[\"Smoking\"] = data[\"Smoking\"].map(dict(Yes=1, No=0))\ndata[\"AlcoholDrinking\"] = data[\"AlcoholDrinking\"].map(dict(Yes=1, No=0))\ndata[\"DiffWalking\"] = data[\"DiffWalking\"].map(dict(Yes=1, No=0))\ndata[\"Stroke\"] = data[\"Stroke\"].map(dict(Yes=1, No=0))\n# data[\"Diabetic\"] = data[\"Diabetic\"].map(dict(Yes=1, No=0))\ndata[\"PhysicalActivity\"] = data[\"PhysicalActivity\"].map(dict(Yes=1, No=0))\ndata[\"Asthma\"] = data[\"Asthma\"].map(dict(Yes=1, No=0))\ndata[\"KidneyDisease\"] = data[\"KidneyDisease\"].map(dict(Yes=1, No=0))\ndata[\"SkinCancer\"] = data[\"SkinCancer\"].map(dict(Yes=1, No=0))\ndata[\"Sex\"] = data[\"Sex\"].map(dict(Female=1, Male=0))\ndata[\"HeartDisease\"] = data[\"HeartDisease\"].map(dict(Yes=1, No=0))\ndata[\"AgeCategory\"] = data[\"AgeCategory\"].map({\"18-24\":0, \"25-29\":1, \"30-34\":2, \"35-39\":3, \"40-44\":4, \"45-49\":5, \"50-54\":6, \"55-59\":7, \"60-64\":8, \"65-69\":9, \"70-74\":10, \"75-79\":11, \"80 or older\":12})\ndata[\"GenHealth\"] = data[\"GenHealth\"].map({\"Poor\":0, \"Fair\":1, \"Good\":2, \"Very good\":3, \"Excellent\":4})","kernel":"ds_env","metadata":{"id":"kNd80j__-eWT"},"pos":2,"start":1657304047592,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304050547,"exec_count":6,"id":"b0d624","input":"race_dummies = pd.get_dummies(data[\"Race\"])\ndiabetes_dummies = pd.get_dummies(data['Diabetic'])","kernel":"ds_env","metadata":{"id":"4EdOo69p-eWU"},"pos":3,"start":1657304050476,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304052867,"exec_count":7,"id":"422e5e","input":"data = pd.concat([data, race_dummies], axis = 1)\ndata = pd.concat([data, diabetes_dummies], axis = 1)\ndata = data.drop(columns = 'Race')\ndata = data.drop(columns = 'Diabetic')\ndata.columns","kernel":"ds_env","metadata":{"id":"G2FJ28Hn-eWV","outputId":"d72b0b6b-cc01-4191-fec7-c5639e16723f"},"output":{"0":{"data":{"text/plain":"Index(['HeartDisease', 'BMI', 'Smoking', 'AlcoholDrinking', 'Stroke',\n       'PhysicalHealth', 'MentalHealth', 'DiffWalking', 'Sex', 'AgeCategory',\n       'PhysicalActivity', 'GenHealth', 'SleepTime', 'Asthma', 'KidneyDisease',\n       'SkinCancer', 'American Indian/Alaskan Native', 'Asian', 'Black',\n       'Hispanic', 'Other', 'White', 'No', 'No, borderline diabetes', 'Yes',\n       'Yes (during pregnancy)'],\n      dtype='object')"},"exec_count":7}},"pos":4,"start":1657304052742,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304055997,"exec_count":8,"id":"74c958","input":"data","kernel":"ds_env","metadata":{"id":"OIA2M698-eWZ","outputId":"cf4e7529-8dad-4d69-981e-f91df61819f1"},"output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HeartDisease</th>\n      <th>BMI</th>\n      <th>Smoking</th>\n      <th>AlcoholDrinking</th>\n      <th>Stroke</th>\n      <th>PhysicalHealth</th>\n      <th>MentalHealth</th>\n      <th>DiffWalking</th>\n      <th>Sex</th>\n      <th>AgeCategory</th>\n      <th>...</th>\n      <th>American Indian/Alaskan Native</th>\n      <th>Asian</th>\n      <th>Black</th>\n      <th>Hispanic</th>\n      <th>Other</th>\n      <th>White</th>\n      <th>No</th>\n      <th>No, borderline diabetes</th>\n      <th>Yes</th>\n      <th>Yes (during pregnancy)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>16.60</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3.0</td>\n      <td>30.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>7</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>20.34</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>12</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>26.58</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>20.0</td>\n      <td>30.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>9</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0</td>\n      <td>24.21</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>11</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>23.71</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>28.0</td>\n      <td>0.0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>4</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>319790</th>\n      <td>1</td>\n      <td>27.41</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>8</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319791</th>\n      <td>0</td>\n      <td>29.84</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319792</th>\n      <td>0</td>\n      <td>24.24</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>5</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319793</th>\n      <td>0</td>\n      <td>32.81</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319794</th>\n      <td>0</td>\n      <td>46.56</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>12</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>319795 rows × 26 columns</p>\n</div>","text/plain":"        HeartDisease    BMI  Smoking  AlcoholDrinking  Stroke  PhysicalHealth  \\\n0                  0  16.60        1                0       0             3.0   \n1                  0  20.34        0                0       1             0.0   \n2                  0  26.58        1                0       0            20.0   \n3                  0  24.21        0                0       0             0.0   \n4                  0  23.71        0                0       0            28.0   \n...              ...    ...      ...              ...     ...             ...   \n319790             1  27.41        1                0       0             7.0   \n319791             0  29.84        1                0       0             0.0   \n319792             0  24.24        0                0       0             0.0   \n319793             0  32.81        0                0       0             0.0   \n319794             0  46.56        0                0       0             0.0   \n\n        MentalHealth  DiffWalking  Sex  AgeCategory  ...  \\\n0               30.0            0    1            7  ...   \n1                0.0            0    1           12  ...   \n2               30.0            0    0            9  ...   \n3                0.0            0    1           11  ...   \n4                0.0            1    1            4  ...   \n...              ...          ...  ...          ...  ...   \n319790           0.0            1    0            8  ...   \n319791           0.0            0    0            3  ...   \n319792           0.0            0    1            5  ...   \n319793           0.0            0    1            1  ...   \n319794           0.0            0    1           12  ...   \n\n        American Indian/Alaskan Native  Asian  Black  Hispanic  Other  White  \\\n0                                    0      0      0         0      0      1   \n1                                    0      0      0         0      0      1   \n2                                    0      0      0         0      0      1   \n3                                    0      0      0         0      0      1   \n4                                    0      0      0         0      0      1   \n...                                ...    ...    ...       ...    ...    ...   \n319790                               0      0      0         1      0      0   \n319791                               0      0      0         1      0      0   \n319792                               0      0      0         1      0      0   \n319793                               0      0      0         1      0      0   \n319794                               0      0      0         1      0      0   \n\n        No  No, borderline diabetes  Yes  Yes (during pregnancy)  \n0        0                        0    1                       0  \n1        1                        0    0                       0  \n2        0                        0    1                       0  \n3        1                        0    0                       0  \n4        1                        0    0                       0  \n...     ..                      ...  ...                     ...  \n319790   0                        0    1                       0  \n319791   1                        0    0                       0  \n319792   1                        0    0                       0  \n319793   1                        0    0                       0  \n319794   1                        0    0                       0  \n\n[319795 rows x 26 columns]"},"exec_count":8}},"pos":5,"scrolled":true,"start":1657304055923,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304060000,"exec_count":9,"id":"3df88b","input":"hd_corr = data.corr()['HeartDisease'].abs().sort_values()\nhd_corr","kernel":"ds_env","metadata":{"id":"DEGz296P-eWa"},"output":{"0":{"data":{"text/plain":"Other                             0.003039\nSleepTime                         0.008327\nAmerican Indian/Alaskan Native    0.008547\nBlack                             0.010156\nYes (during pregnancy)            0.013930\nNo, borderline diabetes           0.016182\nMentalHealth                      0.028591\nAsian                             0.030262\nAlcoholDrinking                   0.032080\nHispanic                          0.036163\nWhite                             0.040121\nAsthma                            0.041444\nBMI                               0.051803\nSex                               0.070040\nSkinCancer                        0.093317\nPhysicalActivity                  0.100030\nSmoking                           0.107764\nKidneyDisease                     0.145197\nPhysicalHealth                    0.170721\nNo                                0.170977\nYes                               0.183072\nStroke                            0.196835\nDiffWalking                       0.201258\nAgeCategory                       0.233432\nGenHealth                         0.243182\nHeartDisease                      1.000000\nName: HeartDisease, dtype: float64"},"exec_count":9}},"pos":6,"start":1657304058773,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304061506,"exec_count":10,"id":"b2218f","input":"cols_to_drop = hd_corr.index[:14].values","kernel":"ds_env","pos":7,"start":1657304061503,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304064002,"exec_count":11,"id":"be89dd","input":"data = data.drop(columns = cols_to_drop)\ndata","kernel":"ds_env","metadata":{"id":"MWMowlfe-eWd"},"output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HeartDisease</th>\n      <th>Smoking</th>\n      <th>Stroke</th>\n      <th>PhysicalHealth</th>\n      <th>DiffWalking</th>\n      <th>AgeCategory</th>\n      <th>PhysicalActivity</th>\n      <th>GenHealth</th>\n      <th>KidneyDisease</th>\n      <th>SkinCancer</th>\n      <th>No</th>\n      <th>Yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>3.0</td>\n      <td>0</td>\n      <td>7</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>12</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20.0</td>\n      <td>0</td>\n      <td>9</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>11</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>28.0</td>\n      <td>1</td>\n      <td>4</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>319790</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.0</td>\n      <td>1</td>\n      <td>8</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>319791</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319792</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319793</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319794</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>12</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>319795 rows × 12 columns</p>\n</div>","text/plain":"        HeartDisease  Smoking  Stroke  PhysicalHealth  DiffWalking  \\\n0                  0        1       0             3.0            0   \n1                  0        0       1             0.0            0   \n2                  0        1       0            20.0            0   \n3                  0        0       0             0.0            0   \n4                  0        0       0            28.0            1   \n...              ...      ...     ...             ...          ...   \n319790             1        1       0             7.0            1   \n319791             0        1       0             0.0            0   \n319792             0        0       0             0.0            0   \n319793             0        0       0             0.0            0   \n319794             0        0       0             0.0            0   \n\n        AgeCategory  PhysicalActivity  GenHealth  KidneyDisease  SkinCancer  \\\n0                 7                 1          3              0           1   \n1                12                 1          3              0           0   \n2                 9                 1          1              0           0   \n3                11                 0          2              0           1   \n4                 4                 1          3              0           0   \n...             ...               ...        ...            ...         ...   \n319790            8                 0          1              0           0   \n319791            3                 1          3              0           0   \n319792            5                 1          2              0           0   \n319793            1                 0          2              0           0   \n319794           12                 1          2              0           0   \n\n        No  Yes  \n0        0    1  \n1        1    0  \n2        0    1  \n3        1    0  \n4        1    0  \n...     ..  ...  \n319790   0    1  \n319791   1    0  \n319792   1    0  \n319793   1    0  \n319794   1    0  \n\n[319795 rows x 12 columns]"},"exec_count":11}},"pos":8,"start":1657304063964,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304066883,"exec_count":12,"id":"3e560b","input":"data = data.drop(columns = 'Yes')","kernel":"ds_env","metadata":{"id":"DN8XStQG-eWd"},"pos":9,"start":1657304066843,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304068644,"exec_count":13,"id":"cf0883","input":"data","kernel":"ds_env","metadata":{"id":"mtnHm_EK-eWd"},"output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HeartDisease</th>\n      <th>Smoking</th>\n      <th>Stroke</th>\n      <th>PhysicalHealth</th>\n      <th>DiffWalking</th>\n      <th>AgeCategory</th>\n      <th>PhysicalActivity</th>\n      <th>GenHealth</th>\n      <th>KidneyDisease</th>\n      <th>SkinCancer</th>\n      <th>No</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>3.0</td>\n      <td>0</td>\n      <td>7</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>12</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20.0</td>\n      <td>0</td>\n      <td>9</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>11</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>28.0</td>\n      <td>1</td>\n      <td>4</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>319790</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.0</td>\n      <td>1</td>\n      <td>8</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319791</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>319792</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>319793</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>319794</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>12</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>319795 rows × 11 columns</p>\n</div>","text/plain":"        HeartDisease  Smoking  Stroke  PhysicalHealth  DiffWalking  \\\n0                  0        1       0             3.0            0   \n1                  0        0       1             0.0            0   \n2                  0        1       0            20.0            0   \n3                  0        0       0             0.0            0   \n4                  0        0       0            28.0            1   \n...              ...      ...     ...             ...          ...   \n319790             1        1       0             7.0            1   \n319791             0        1       0             0.0            0   \n319792             0        0       0             0.0            0   \n319793             0        0       0             0.0            0   \n319794             0        0       0             0.0            0   \n\n        AgeCategory  PhysicalActivity  GenHealth  KidneyDisease  SkinCancer  \\\n0                 7                 1          3              0           1   \n1                12                 1          3              0           0   \n2                 9                 1          1              0           0   \n3                11                 0          2              0           1   \n4                 4                 1          3              0           0   \n...             ...               ...        ...            ...         ...   \n319790            8                 0          1              0           0   \n319791            3                 1          3              0           0   \n319792            5                 1          2              0           0   \n319793            1                 0          2              0           0   \n319794           12                 1          2              0           0   \n\n        No  \n0        0  \n1        1  \n2        0  \n3        1  \n4        1  \n...     ..  \n319790   0  \n319791   1  \n319792   1  \n319793   1  \n319794   1  \n\n[319795 rows x 11 columns]"},"exec_count":13}},"pos":10,"start":1657304068623,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304075344,"exec_count":15,"id":"e6efaf","input":"no_hd_count, hd_count = data.HeartDisease.value_counts()\nno_hd = data[data['HeartDisease'] == 0]\nhd = data[data['HeartDisease'] == 1]\nno_hd_sample = no_hd.sample(hd_count)","kernel":"ds_env","metadata":{"id":"r19MR2FB-eWg"},"pos":11,"start":1657304075259,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304078159,"exec_count":16,"id":"b6bc38","input":"undersampled_df = pd.concat([no_hd_sample, hd], axis=0)","kernel":"ds_env","metadata":{"id":"ZAT-E1AA-eWg"},"pos":12,"start":1657304078150,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304080273,"exec_count":17,"id":"bb89b6","input":"undersampled_df","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HeartDisease</th>\n      <th>Smoking</th>\n      <th>Stroke</th>\n      <th>PhysicalHealth</th>\n      <th>DiffWalking</th>\n      <th>AgeCategory</th>\n      <th>PhysicalActivity</th>\n      <th>GenHealth</th>\n      <th>KidneyDisease</th>\n      <th>SkinCancer</th>\n      <th>No</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>14892</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>11</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>192249</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>2</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>251411</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>12.0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>214119</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>9</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>229741</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>6</td>\n      <td>1</td>\n      <td>4</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>319765</th>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>30.0</td>\n      <td>1</td>\n      <td>7</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319767</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>1</td>\n      <td>11</td>\n      <td>1</td>\n      <td>2</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319781</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>319786</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>8</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>319790</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.0</td>\n      <td>1</td>\n      <td>8</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>54746 rows × 11 columns</p>\n</div>","text/plain":"        HeartDisease  Smoking  Stroke  PhysicalHealth  DiffWalking  \\\n14892              0        0       0             0.0            0   \n192249             0        0       0             0.0            0   \n251411             0        0       0            12.0            0   \n214119             0        0       0             0.0            0   \n229741             0        1       0             0.0            0   \n...              ...      ...     ...             ...          ...   \n319765             1        0       1            30.0            1   \n319767             1        1       0             0.0            1   \n319781             1        1       0             0.0            0   \n319786             1        1       0             0.0            0   \n319790             1        1       0             7.0            1   \n\n        AgeCategory  PhysicalActivity  GenHealth  KidneyDisease  SkinCancer  \\\n14892            11                 1          3              0           0   \n192249            2                 1          3              0           0   \n251411            3                 1          1              0           0   \n214119            9                 1          2              0           0   \n229741            6                 1          4              0           0   \n...             ...               ...        ...            ...         ...   \n319765            7                 1          0              0           0   \n319767           11                 1          2              0           0   \n319781            3                 1          3              0           0   \n319786            8                 1          3              0           0   \n319790            8                 0          1              0           0   \n\n        No  \n14892    0  \n192249   1  \n251411   1  \n214119   1  \n229741   1  \n...     ..  \n319765   0  \n319767   0  \n319781   1  \n319786   0  \n319790   0  \n\n[54746 rows x 11 columns]"},"exec_count":17}},"pos":13,"start":1657304080253,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304085155,"exec_count":19,"id":"a9ade8","input":"X = undersampled_df.drop(columns = 'HeartDisease')\ny = undersampled_df['HeartDisease']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)","kernel":"ds_env","metadata":{"id":"Oh76pkOm-eWi"},"pos":14,"start":1657304085141,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304305820,"exec_count":23,"id":"d605b8","input":"y_pred = model.predict(X_test)","kernel":"ds_env","metadata":{"id":"PEMldwl9-eWi"},"pos":20,"start":1657304305402,"state":"done","type":"cell"}
{"cell_type":"code","end":1657304343296,"exec_count":24,"id":"da6203","input":"accuracy_score(y_test, y_pred)","kernel":"ds_env","metadata":{"id":"xuZu6QhC-eWi"},"output":{"0":{"data":{"text/plain":"0.73662100456621"},"exec_count":24}},"pos":21,"start":1657304343282,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"410ab1","input":"","metadata":{"id":"w9MQ5DN2-eWj"},"pos":22,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5e119c","input":"","metadata":{"id":"mSUOUY3p-eWj"},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"c70e2e","input":"grid.best_estimators_","metadata":{"id":"46NYDXgF-eWi"},"pos":17,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"f83bea","input":"","metadata":{"id":"lSKhgWtB-eWi"},"pos":18,"type":"cell"}
{"cell_type":"code","exec_count":27,"id":"07d6d7","input":"\nfrom sklearn.ensemble import RandomForestClassifier\nmodel = RandomForestClassifier().fit(X_train, y_train)\n","kernel":"ds_env","metadata":{"id":"jmnGFlmW-eWi"},"output":{"0":{"data":{"text/plain":"<bound method ForestClassifier.predict of RandomForestClassifier()>"},"exec_count":27}},"pos":19,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":77,"id":"bcec65","input":"model = SVC()\nmodel.fit(X_train, y_train)\ny_preds = model.predict(X_test)\naccuracy_score(y_test, y_preds)","metadata":{"id":"d2Mhis56-eWi"},"output":{"0":{"data":{"text/plain":"0.750593607305936"},"execution_count":77,"metadata":{},"output_type":"execute_result"}},"pos":15,"type":"cell"}
{"cell_type":"code","exec_count":78,"id":"80a952","input":"param_grid = {'C': [0.1, 1, 10, 100],\n              'gamma': [1, 0.1, 0.01, 0.001],\n              'kernel': ['rbf']}\n\ngrid = GridSearchCV(SVC(), param_grid, refit = True, verbose = 3)\n\ngrid.fit(X_train, y_train)","metadata":{"id":"14QfX7qI-eWi"},"output":{"0":{"name":"stdout","output_type":"stream","text":"Fitting 5 folds for each of 16 candidates, totalling 80 fits\n"},"1":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ........C=0.1, gamma=1, kernel=rbf;, score=0.739 total time= 1.6min\n"},"10":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ......C=0.1, gamma=0.1, kernel=rbf;, score=0.751 total time= 1.1min\n"},"11":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END .....C=0.1, gamma=0.01, kernel=rbf;, score=0.757 total time= 1.1min\n"},"12":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END .....C=0.1, gamma=0.01, kernel=rbf;, score=0.752 total time= 1.1min\n"},"13":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END .....C=0.1, gamma=0.01, kernel=rbf;, score=0.748 total time= 1.1min\n"},"14":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END .....C=0.1, gamma=0.01, kernel=rbf;, score=0.742 total time= 1.1min\n"},"15":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END .....C=0.1, gamma=0.01, kernel=rbf;, score=0.746 total time= 1.1min\n"},"16":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ....C=0.1, gamma=0.001, kernel=rbf;, score=0.749 total time= 1.1min\n"},"17":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ....C=0.1, gamma=0.001, kernel=rbf;, score=0.746 total time= 1.1min\n"},"18":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ....C=0.1, gamma=0.001, kernel=rbf;, score=0.741 total time= 1.1min\n"},"19":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ....C=0.1, gamma=0.001, kernel=rbf;, score=0.736 total time= 1.1min\n"},"2":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ........C=0.1, gamma=1, kernel=rbf;, score=0.739 total time= 1.6min\n"},"20":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ....C=0.1, gamma=0.001, kernel=rbf;, score=0.741 total time= 1.1min\n"},"21":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ..........C=1, gamma=1, kernel=rbf;, score=0.750 total time= 2.2min\n"},"22":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ..........C=1, gamma=1, kernel=rbf;, score=0.748 total time= 2.2min\n"},"23":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ..........C=1, gamma=1, kernel=rbf;, score=0.743 total time= 2.2min\n"},"24":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ..........C=1, gamma=1, kernel=rbf;, score=0.740 total time= 2.2min\n"},"25":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ..........C=1, gamma=1, kernel=rbf;, score=0.744 total time= 2.2min\n"},"26":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ........C=1, gamma=0.1, kernel=rbf;, score=0.761 total time= 1.5min\n"},"27":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ........C=1, gamma=0.1, kernel=rbf;, score=0.755 total time= 1.4min\n"},"28":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ........C=1, gamma=0.1, kernel=rbf;, score=0.750 total time= 1.7min\n"},"29":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ........C=1, gamma=0.1, kernel=rbf;, score=0.750 total time= 2.9min\n"},"3":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ........C=0.1, gamma=1, kernel=rbf;, score=0.734 total time= 1.8min\n"},"30":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ........C=1, gamma=0.1, kernel=rbf;, score=0.753 total time= 2.9min\n"},"31":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END .......C=1, gamma=0.01, kernel=rbf;, score=0.759 total time= 1.8min\n"},"32":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END .......C=1, gamma=0.01, kernel=rbf;, score=0.753 total time= 2.0min\n"},"33":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END .......C=1, gamma=0.01, kernel=rbf;, score=0.749 total time= 2.0min\n"},"34":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END .......C=1, gamma=0.01, kernel=rbf;, score=0.748 total time= 2.0min\n"},"35":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END .......C=1, gamma=0.01, kernel=rbf;, score=0.751 total time= 1.8min\n"},"36":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ......C=1, gamma=0.001, kernel=rbf;, score=0.758 total time= 2.1min\n"},"37":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ......C=1, gamma=0.001, kernel=rbf;, score=0.754 total time= 1.8min\n"},"38":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ......C=1, gamma=0.001, kernel=rbf;, score=0.749 total time= 2.1min\n"},"39":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ......C=1, gamma=0.001, kernel=rbf;, score=0.747 total time= 1.8min\n"},"4":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ........C=0.1, gamma=1, kernel=rbf;, score=0.734 total time= 1.6min\n"},"40":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ......C=1, gamma=0.001, kernel=rbf;, score=0.749 total time= 2.1min\n"},"41":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END .........C=10, gamma=1, kernel=rbf;, score=0.733 total time= 6.0min\n"},"42":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END .........C=10, gamma=1, kernel=rbf;, score=0.731 total time= 3.4min\n"},"5":{"name":"stdout","output_type":"stream","text":"[CV 5/5] END ........C=0.1, gamma=1, kernel=rbf;, score=0.736 total time= 1.6min\n"},"6":{"name":"stdout","output_type":"stream","text":"[CV 1/5] END ......C=0.1, gamma=0.1, kernel=rbf;, score=0.759 total time= 1.1min\n"},"7":{"name":"stdout","output_type":"stream","text":"[CV 2/5] END ......C=0.1, gamma=0.1, kernel=rbf;, score=0.753 total time= 1.2min\n"},"8":{"name":"stdout","output_type":"stream","text":"[CV 3/5] END ......C=0.1, gamma=0.1, kernel=rbf;, score=0.749 total time= 1.1min\n"},"9":{"name":"stdout","output_type":"stream","text":"[CV 4/5] END ......C=0.1, gamma=0.1, kernel=rbf;, score=0.746 total time= 1.2min\n"}},"pos":16,"type":"cell"}
{"id":"63ce87","input":"","pos":0.5,"type":"cell"}
{"id":"6ab521","input":"","pos":-1,"type":"cell"}
{"id":0,"time":1657562640858,"type":"user"}
{"last_load":1657304021426,"type":"file"}